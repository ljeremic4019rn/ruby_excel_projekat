# D:\sj_ruby_domacizadatak\sj_ruby_domacizadatak/xlsx_app.arb

require 'roo'

testarr =  Array.new(6){Array.new}

class XlsxFile
    attr_accessor :path, :file, :table, :row

    def initialize(path)
        @path = path
        @file = Roo::Spreadsheet.open("#@path")
        @file = Roo::Excelx.new("#@path", {:expand_merged_ranges => true})

        @table =  nil
        @row = Array.new(6)
    end

    def initialize_table
        @file.each_with_pagename do |name, sh|
            if sh.first_row != nil then
                @sheet = sh
                
                @table =  Array.new(sh.last_row  - sh.first_row + 1){Array.new(sh.last_column  - sh.first_column + 1)}

                rowCnt = 0
                colCnt = 0

                sh.first_row.upto(sh.last_row) do |row|

                    sh.first_column.upto(sh.last_column) do |column|
                        @table[rowCnt][colCnt] = sh.cell(row, column)
                        colCnt += 1
                    end

                    rowCnt += 1
                    colCnt = 0

                end
            end
        end
    end

    def row(nr)
        @row = table[nr]
    end

    def each(&block)
        @table.each(&block)
    end

end

xl = XlsxFile.new('testFile.xlsx')
puts xl.file.info
xl.initialize_table

p xl.table
#p xl.row(2)[3]
# xl.each do |cell|
#     p cell
# end